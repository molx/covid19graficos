var starttimeBR,starttimeW,starttimeHS;function dateToDM(d){var a=d.getDate(),b=d.getMonth()+1;return""+(9>=a?"0"+a:a)+"/"+(9>=b?"0"+b:b)}function numberWithSep(b){return b.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function isArray(b){return"[object Array]"===Object.prototype.toString.call(b)}function splat(b){return isArray(b)?b:[b]}function formatToChart(l,g,b="date"){const a=[...new Set(l.map(b=>b.location))];let c=[];return a.forEach(function(e){let d,a=l.filter(function(b){return b.location==e}),m=[],h=!0;a.forEach(function(c){(c[g]||!h)&&(h=!1,d={},d.x="date"==b?Date.parse(c[b]):c[b],d.y=c[g],Object.keys(c).map(a=>d[a]=c[a]),m.push(d))}),c.push({name:e,data:m})}),c}function formatToColumnChart(g,a,b){let c=[{data:[]}];const d=Object.values(g).reduce((c,d)=>+c+d[b],0);for(i=0;i<g.length;i++)if("CFR"==b)c[0].data.push({name:g[i][a],y:g[i][b],color:myColors[i],deaths:g[i].total_deaths,cases:g[i].total_cases});else{let e=Math.round(1e4*g[i][b]/d)/100;c[0].data.push({name:g[i][a],y:g[i][b],color:myColors[i],pct:e})}c[0].data.sort((b,c)=>parseFloat(c.y)-parseFloat(b.y));let e=[...new Set(c[0].data.map(b=>b.name))];return{series:c,order:e}}function summarise(l,m,b,n,d,e=!1){isArray(b)||(b=[b]);var f=[];for(v=0;v<b.length;v++){f[b[v]]||(f[b[v]]={});for(let a=0;a<l.length;a++)f[b[v]][l[a][m]]?f[b[v]][l[a][m]]+=l[a][b[v]]:f[b[v]][l[a][m]]=l[a][b[v]]}var g={},h=[];for(i=0;i<Object.keys(f[b[0]]).length;i++){let c=Object.assign({},g),a=Object.keys(f[b[0]])[i];for(c[m]=a,c[n]=d,v=0;v<b.length;v++)c[b[v]]=e?0<i?Math.round(1e4*(f[b[v]][a]-f[b[v]][Object.keys(f[b[v]])[i-1]])/f[b[v]][Object.keys(f[b[v]])[i-1]])/100:0:f[b[v]][a];h.push(c)}return h}function alignData(g,a,b){var c=[],d=[];for(i=0;i<g.length;i++)100<=g[i][a]&&c.push(g[i]);c.sort((b,c)=>b.location>c.location?1:c.location>b.location?-1:0);let e=c[0].location;for(d.push(c[0]),d[0][b]=1,i=1;i<c.length;i++)c[i].location==e?(d.push(c[i]),d[i][b]=d[i-1][b]+1):(d.push(c[i]),d[i][b]=1,e=c[i].location);return d}function getLastDate2(d){let e=d[d.length-1].date.getTime(),a=d.filter(function(b){return b.date.getTime()==e});return a}function getCFR(e,a=!0){let b=[];for(Object.assign(b,e),a&&(b=getLastDate(b)),i=0;i<b.length;i++)b[i].CFR=Math.round(1e4*b[i].total_deaths/b[i].total_cases)/100,b[i].CFR=isNaN(b[i].CFR)?0:b[i].CFR;let f=b.filter(function(b){return 20<=b.total_deaths});return f}function daysToMs(b){return 1e3*(3600*(24*b))}var regioes={Sudeste:["S\xE3o Paulo","Rio de Janeiro","Minas Gerais","Esp\xEDrito Santo"],"Centro-Oeste":["Distrito Federal","Goi\xE1s","Mato Grosso","Mato Grosso do Sul"],Nordeste:["Maranh\xE3o","Piau\xED","Cear\xE1","Rio Grande do Norte","Para\xEDba","Pernambuco","Alagoas","Sergipe","Bahia"],Sul:["Paran\xE1","Santa Catarina","Rio Grande do Sul"],Norte:["Acre","Amazonas","Par\xE1","Rond\xF4nia","Roraima","Amap\xE1","Tocantins"]},acronyms={Acre:"AC",Alagoas:"AL",Amazonas:"AM",Bahia:"BA",Ceará:"CE","Distrito Federal":"DF","Espírito Santo":"ES",Goiás:"GO",Amapá:"AP",Maranhão:"MA","Mato Grosso":"MT","Mato Grosso do Sul":"MS","Minas Gerais":"MG",Paraná:"PR",Paraíba:"PB",Pará:"PA",Pernambuco:"PE",Piauí:"PI","Rio Grande do Norte":"RN","Rio Grande do Sul":"RS","Rio de Janeiro":"RJ",Rondônia:"RO",Roraima:"RR","Santa Catarina":"SC",Sergipe:"SE","São Paulo":"SP",Tocantins:"TO"},nomesEstados=Object.keys(acronyms).sort();regioes.Brasil=nomesEstados;var myColors=["#2b547e"].concat(palette("mpn65",26).map(b=>"#"+b)),highchartsOptions=Highcharts.setOptions({lang:{loading:"Aguarde...",months:["Janeiro","Fevereiro","Mar\xE7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdays:["Domingo","Segunda","Ter\xE7a","Quarta","Quinta","Sexta","S\xE1bado"],shortMonths:["Jan","Feb","Mar","Abr","Maio","Jun","Jul","Ago","Set","Out","Nov","Dez"],viewFullscreen:"Ver em tela cheia",exitFullscreen:"Sair da tela cheia",printChart:"Imprimir",rangeSelectorFrom:"De",rangeSelectorTo:"At\xE9",rangeSelectorZoom:"Periodo",downloadPNG:"Download imagem PNG",downloadJPEG:"Download imagem JPEG",downloadPDF:"Download documento PDF",downloadSVG:"Download imagem SVG",numericSymbols:null,thousandsSep:".",resetZoom:"Resetar zoom"},chart:{spacingBottom:16,zoomType:"x",resetZoomButton:{position:{x:-150,y:10},relativeTo:"chart",theme:{height:14}},panning:!0,panKey:"ctrl"},yAxis:{endOnTick:!1},title:{align:"left"},subtitle:{align:"left",y:30,margin:0},caption:{text:"Fonte: Minist\xE9rio da Sa\xFAde",margin:0,y:25},credits:{text:"covid19graficos.com.br",href:"http://covid19graficos.com.br",position:{x:-12}},colors:myColors});function changeType(c,a){c.yAxis[0].isLog?(c.yAxis[0].update({type:"linear"},!1,!1,!1),c.exportSVGElements[2].attr({text:"Logar\xEDtmica"})):(c.yAxis[0].update({type:"logarithmic"},!1,!1,!1),c.exportSVGElements[2].attr({text:"Linear"})),c.redraw(a)}function createLineChart(b){Highcharts.chart({chart:{renderTo:b,type:"line",styledMode:!1},data:{dateFormat:"YYYY-mm-dd"},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%d/%m"},tickInterval:daysToMs(1),labels:{rotation:-45}},yAxis:{min:1,labels:{format:"{value:,.0f}"}},legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!0,radius:3}}},tooltip:{crosshairs:!0,shared:!0,dateTimeLabelFormats:{day:"%A, %d/%m/%Y"},outside:!0,formatter:function(d){var a=this.points||splat(this),b=a[0].series;return a.sort(function(b,c){return b.y<c.y?1:b.y>c.y?-1:0}),d.defaultFormatter.call(this,d)}},defs:{custombtn:{tagName:"pattern",id:"custom-btn-bg",width:100}},exporting:{buttons:{customButton:{text:"Logar\xEDtmica",id:"btn",onclick:function(){changeType(this,!0)},theme:{width:70,"text-align":"center",stroke:"#000",r:6}}}}})}function createColumnChart(c,e=null){Highcharts.chart(c,{chart:{type:"column"},plotOptions:{series:{groupPadding:0,colorByPoint:!1}},tooltip:{shared:!0,formatter:function(){var b,f=this.point,c=this.series;return b=this.points[0].point.pct,name=this.points[0].point.name,"<small>"+name+"</small>:<br><b>"+this.y+"</b> ("+b+"% dos "+e+")"}},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!1,labelFormatter:function(){return acronyms[this.name]}}})}function createTimeColumnChart(b){Highcharts.chart(b,{chart:{type:"column"},plotOptions:{series:{groupPadding:0,colorByPoint:!1}},data:{dateFormat:"YYYY-mm-dd"},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%d/%m"},tickInterval:daysToMs(1),labels:{rotation:-45}},tooltip:{crosshairs:!0,shared:!0,dateTimeLabelFormats:{day:"%A, %d/%m/%Y"},outside:!0},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!1,labelFormatter:function(){return acronyms[this.name]}}})}const msGetURL="https://xx9p7hp1p7.execute-api.us-east-1.amazonaws.com/prod/PortalGeral";let brasilDataSource,rawBrasilData,brasilData;var loadedBrasilData=!1,loadedWorldData=!1;function parseBrasilData(b){if(console.log("Time to download Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),b){parsedData=Papa.parse(rawBrasilData,{header:!0,dynamicTyping:!0,skipEmptyLines:!0}).data,console.log("Time to parse Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime();let d=Object.values(parsedData[0]),a="string"==typeof d[2]&&3==d[2].split("/").length,b=Object.keys(parsedData[0]);if(refCols=["date","location","new_cases","total_cases","new_deaths","total_deaths"],!a)console.log("Succesfully fetched MS data but date column is invalid, using manual data instead.");else if(!refCols.every(c=>b.includes(c)))console.log("Succesfully fetched MS data but at least one column is missing or misnamed.");else{parsedData.map(b=>b.date=b.date.split("/").reverse().join("-")),parsedData.map(c=>c.location=Object.keys(acronyms).find(a=>acronyms[a]===c.location));let c=new Date(estados[estados.length-1].date).getTime(),a=new Date(parsedData[parsedData.length-1].date).getTime();a>c?(console.log("Succesfully fetched MS data."),estados=parsedData):console.log("Succesfully fetched MS data but file is outdated or corrupted, using manual data instead.")}}console.log("Time to check Brasil MS data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),brasilData=summarise(estados,"date",["total_cases","total_deaths","new_cases","new_deaths"],"location","Brasil"),console.log("Time to summarise Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),brasilData=addColumns(brasilData),estados=addColumns(estados),loadedBrasilData=!0,console.log("Time to process Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),loadedWorldData&&(generatePlots(),loadedBrasilData=!1)}let rawWorldData,worldData;const worldDataSource="https://covid.ourworldindata.org/data/ecdc/full_data.csv",worldCompare=["Brasil","It\xE1lia","Estados Unidos","Espanha","Alemanha","Reino Unido","Coreia do Sul"];function parseWorldData(){console.log("Time to download World data: "+(new Date().getTime()-starttimeW)+"ms"),starttimeW=new Date().getTime(),worldData=Papa.parse(rawWorldData,{header:!0,dynamicTyping:!0,skipEmptyLines:!0}).data,console.log("Time to parse World data: "+(new Date().getTime()-starttimeW)+"ms"),starttimeW=new Date().getTime(),worldData.map(b=>b.location=worldTrad[b.location]?worldTrad[b.location]:b.location),worldData=addColumns(worldData),loadedWorldData=!0,console.log("Time to process World data: "+(new Date().getTime()-starttimeW)+"ms"),loadedBrasilData&&(generatePlots(),loadedWorldData=!1)}function addColumns(h){let a=864e5,b=[];h.map(b=>b.date=new Date(b.date));let d=[...new Set(h.map(b=>b.location))];for(i=0;i<d.length;i++){let c=1/0,e=1/0,f=h.filter(b=>b.location==d[i]);for(f[0].change_cases=0,f[0].change_deaths=0,j=1;j<f.length;j++)f[j].change_cases=Math.round(1e4*f[j].new_cases/f[j-1].total_cases)/100,f[j].change_deaths=Math.round(1e4*f[j].new_deaths/f[j-1].total_deaths)/100,c==1/0&&100<=f[j].total_cases&&(c=f[j].date),e==1/0&&100<=f[j].total_deaths&&(e=f[j].date),f[j].day_cases=(f[j].date-c)/a+1,f[j].day_deaths=(f[j].date-e)/a+1,f[j].CFR=Math.round(1e4*f[j].total_deaths/f[j].total_cases)/100;b=b.concat(f)}return b}function addColumns2(g){let a=864e5;g.map(b=>b.date=new Date(b.date));let h=[...new Set(g.map(b=>b.location))],k={},d={};for(i=0;i<h.length;i++){let a=g.find(b=>b.location==h[i]&&100<=b.total_cases);k[h[i]]=a?a.date:1/0;let b=g.find(b=>b.location==h[i]&&100<=b.total_deaths);d[h[i]]=b?b.date:1/0}for(i=0;i<g.length;i++){let b=g.find(b=>g[i].location==b.location&&g[i].date.getTime()-b.date.getTime()==a);b?(g[i].change_cases=Math.round(1e4*g[i].new_cases/b.total_cases)/100,g[i].change_deaths=Math.round(1e4*g[i].new_deaths/b.total_deaths)/100,g[i].change_cases=isNaN(g[i].change_cases)?0:g[i].change_cases,g[i].change_deaths=isNaN(g[i].change_deaths)?0:g[i].change_deaths):(g[i].change_cases=0,g[i].change_deaths=0),g[i].day_cases=(g[i].date-k[g[i].location])/a+1,g[i].day_deaths=(g[i].date-d[g[i].location])/a+1,g[i].CFR=Math.round(1e4*g[i].total_deaths/g[i].total_cases)/100,g[i].CFR=isNaN(g[i].CFR)?0:g[i].CFR}return g}function pad(b){return 10>b?"0"+b:b}function generatePlots(){starttimeHS=new Date().getTime();var G=brasilData[brasilData.length-1].total_cases,a=brasilData[brasilData.length-1].total_deaths,b=Math.round(1e4*a/G)/100,c=brasilData[brasilData.length-1].date,d=pad(c.getUTCDate())+"/"+pad(c.getUTCMonth()+1)+"/"+c.getUTCFullYear();$("#data_br_dia").html(d),$("#data_br_casos").html(numberWithSep(G)),$("#data_br_obitos").html(numberWithSep(a)),$("#data_br_CFR").html(b.toString().replace(".",",")+"%"),createLineChart("br_casos"),$("#br_casos").highcharts().addSeries({name:"Total de casos",data:formatToChart(brasilData,"total_cases")[0].data},!1),$("#br_casos").highcharts().update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos confirmados"}}),createLineChart("br_obitos"),$("#br_obitos").highcharts().addSeries({name:"Total de \xF3bitos",data:formatToChart(brasilData,"total_deaths")[0].data},!1),$("#br_obitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos"}}),createTimeColumnChart("br_novoscasos"),$("#br_novoscasos").highcharts().addSeries({name:"Novos casos",yAxis:0,data:formatToChart(brasilData,"new_cases")[0].data},!1),$("#br_novoscasos").highcharts().update({yAxis:{title:{text:"Novos casos",style:{color:myColors[0]}},labels:{style:{color:myColors[0]}},min:0},title:{text:"Novos casos"},exporting:{buttons:{customButton:{enabled:!1}}}},!1),$("#br_novoscasos").highcharts().addAxis({title:{text:"Varia\xE7\xE3o em rela\xE7\xE3o ao dia anterior",style:{color:myColors[1]}},min:0,max:100,opposite:!0,labels:{format:"{value}%",style:{color:myColors[1]}}},!1),$("#br_novoscasos").highcharts().addSeries({name:"Aumento",yAxis:1,type:"line",marker:{enabled:!1},data:formatToChart(brasilData,"change_cases")[0].data,tooltip:{valueSuffix:"%"}},!0),createTimeColumnChart("br_novosobitos"),$("#br_novosobitos").highcharts().addSeries({name:"Novos \xF3bitos",data:formatToChart(brasilData,"new_deaths")[0].data},!1),$("#br_novosobitos").highcharts().update({yAxis:{title:{text:"Novos \xF3bitos",style:{color:myColors[0]}},labels:{style:{color:myColors[0]}},min:0},title:{text:"Novos \xF3bitos"},exporting:{buttons:{customButton:{enabled:!1}}}},!1),$("#br_novosobitos").highcharts().addAxis({title:{text:"Varia\xE7\xE3o em rela\xE7\xE3o ao dia anterior",style:{color:myColors[1]}},min:0,max:100,opposite:!0,labels:{format:"{value}%",style:{color:myColors[1]}}},!1),$("#br_novosobitos").highcharts().addSeries({name:"Aumento",yAxis:1,type:"line",marker:{enabled:!1},data:formatToChart(brasilData,"change_deaths")[0].data,tooltip:{valueSuffix:"%"}},!0);let e=formatToChart(brasilData,"CFR","date");createLineChart("br_CFR"),$("#br_CFR").highcharts().addSeries({name:"Taxa de letalidade",data:e[0].data},!1),$("#br_CFR").highcharts().update({chart:{marginTop:50},yAxis:{title:{text:"Varia\xE7\xE3o da letalidade"},labels:{format:"{value}%"}},title:{text:"Letalidade"},subtitle:{text:"A partir do 20\xBA \xF3bito"},tooltip:{shared:!1,valueSuffix:"%"},exporting:{buttons:{customButton:{enabled:!1}}}});let f=formatToColumnChart(getLastDate2(estados),"location","total_cases"),g=jQuery.extend(!0,{},f);for(i=0;i<g.series[0].data.length;i++){var h=g.series[0].data[i];h.y=Math.round(1e7*h.y/populacao[0][h.name])/100}g.series[0].data.sort((b,c)=>parseFloat(c.y)-parseFloat(b.y)),g.order=[...new Set(g.series[0].data.map(b=>b.name))],createColumnChart("estados_dist","casos"),$("#estados_dist").highcharts().addSeries({data:formatToColumnChart(getLastDate2(estados),"location","total_cases").series[0].data},!1),$("#estados_dist").highcharts().update({title:{text:"Distribui\xE7\xE3o de casos por estado"},xAxis:{crosshair:!0,categories:f.order},yAxis:{title:{text:"Casos confirmados"}},exporting:{buttons:{customButton:{text:"Por Habitantes",onclick:function(){"Por Habitantes"==this.exportSVGElements[2].text.textStr?(this.series[0].update({data:g.series[0].data},!1),this.xAxis[0].setCategories(g.order,!1),this.yAxis[0].setTitle({text:"Casos por 100 mil habitantes"}),this.exportSVGElements[2].attr({text:"Total"})):(this.series[0].update({data:f.series[0].data},!1),this.xAxis[0].setCategories(f.order,!1),this.yAxis[0].setTitle({text:"Casos confirmados"}),this.exportSVGElements[2].attr({text:"Por Habitantes"}))},theme:{stroke:"#000",r:6,width:80,"text-align":"center"}}}}});let H=formatToColumnChart(getLastDate2(estados),"location","total_deaths"),l=jQuery.extend(!0,{},H);for(i=0;i<l.series[0].data.length;i++){var h=l.series[0].data[i];h.y=Math.round(1e7*h.y/populacao[0][h.name])/100}l.series[0].data.sort((b,c)=>parseFloat(c.y)-parseFloat(b.y)),l.order=[...new Set(l.series[0].data.map(b=>b.name))],createColumnChart("estados_dist_obitos","\xF3bitos"),$("#estados_dist_obitos").highcharts().addSeries({data:formatToColumnChart(getLastDate2(estados),"location","total_deaths").series[0].data},!1),$("#estados_dist_obitos").highcharts().update({title:{text:"Distribui\xE7\xE3o de \xF3bitos por estado"},xAxis:{crosshair:!0,categories:H.order},yAxis:{title:{text:"\xD3bitos"}},exporting:{buttons:{customButton:{text:"Por Habitantes",onclick:function(){"Por Habitantes"==this.exportSVGElements[2].text.textStr?(this.series[0].update({data:l.series[0].data},!1),this.xAxis[0].setCategories(l.order,!1),this.yAxis[0].setTitle({text:"\xD3bitos por 100 mil habitantes"}),this.exportSVGElements[2].attr({text:"Total"})):(this.series[0].update({data:H.series[0].data},!1),this.xAxis[0].setCategories(H.order,!1),this.yAxis[0].setTitle({text:"\xD3bitos"}),this.exportSVGElements[2].attr({text:"Por Habitantes"}))},theme:{stroke:"#000",r:6,width:80,"text-align":"center"}}}}});var m=estados.filter(function(b){return b.location==$("#sel_estado").val()}),I=m[m.length-1].total_cases,J=m[m.length-1].total_deaths,K=Math.round(1e4*J/I)/100;$("#data_estado_casos").html(numberWithSep(I)),$("#data_estado_obitos").html(numberWithSep(J)),$("#data_estado_CFR").html(K.toString().replace(".",",")+"%"),$("#sel_estado").change(function(){m=estados.filter(function(b){return b.location==$("#sel_estado").val()}),I=m[m.length-1].total_cases,J=m[m.length-1].total_deaths,K=Math.round(1e4*J/I)/100,$("#data_estado_casos").html(numberWithSep(I)),$("#data_estado_obitos").html(numberWithSep(J)),$("#data_estado_CFR").html(K.toString().replace(".",",")+"%");let e=$("#estado_casos").highcharts();e.series[0].update({name:$("#sel_estado").val(),data:formatToChart(m,"total_cases")[0].data},!1),e.setTitle({text:"Casos confirmados - "+$("#sel_estado").val()});let a=$("#estado_obitos").highcharts();a.series[0].update({name:$("#sel_estado").val(),data:formatToChart(m,"total_deaths")[0].data},!1),a.setTitle({text:"\xD3bitos - "+$("#sel_estado").val()});let b=$("#estado_novoscasos").highcharts();b.series[0].update({name:$("#sel_estado").val(),data:formatToChart(m,"new_cases")[0].data},!1),b.setTitle({text:"Novos casos - "+$("#sel_estado").val()});let c=$("#estado_novosobitos").highcharts();c.series[0].update({name:$("#sel_estado").val(),data:formatToChart(m,"new_deaths")[0].data},!1),c.setTitle({text:"Novos \xF3bitos - "+$("#sel_estado").val()}),e.redraw(),a.redraw(),b.redraw(),c.redraw()}),createLineChart("estado_casos"),$("#estado_casos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(m,"total_cases")[0].data},!1),$("#estado_casos").highcharts().update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos confirmados - "+$("#sel_estado").val()}}),createLineChart("estado_obitos"),$("#estado_obitos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(m,"total_deaths")[0].data},!1),$("#estado_obitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos - "+$("#sel_estado").val()}}),createTimeColumnChart("estado_novoscasos"),$("#estado_novoscasos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(m,"new_cases")[0].data},!1),$("#estado_novoscasos").highcharts().update({yAxis:{title:{text:"Novos casos"},min:0},title:{text:"Novos casos - "+$("#sel_estado").val()},exporting:{buttons:{customButton:{enabled:!1}}}},!0),createTimeColumnChart("estado_novosobitos"),$("#estado_novosobitos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(m,"new_deaths")[0].data},!1),$("#estado_novosobitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"},min:0},title:{text:"Novos \xF3bitos - "+$("#sel_estado").val()},exporting:{buttons:{customButton:{enabled:!1}}}},!0),createLineChart("estados_casos");let L=formatToChart(estados,"total_cases"),r=$("#estados_casos").highcharts();for(;0<r.series.length;)r.series[0].remove(!1);for(i=0;i<L.length;i++)r.addSeries({name:L[i].name,data:L[i].data},!1);r.update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos - todos estados"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}},plotOptions:{line:{marker:{enabled:!1}}},exporting:{buttons:{customButton:{onclick:function(){changeType(this,!1)}}}}}),createLineChart("estados_obitos");let s=formatToChart(estados,"total_deaths"),t=$("#estados_obitos").highcharts();for(;0<t.series.length;)t.series[0].remove(!1);for(i=0;i<s.length;i++)t.addSeries({name:s[i].name,data:s[i].data},!1);t.update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos - todos estados"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}}}),createLineChart("regiao_casos"),createLineChart("regiao_obitos"),$("#sel_regiao").change(function(){let e=formatToChart(estados.filter(function(b){return regioes[$("#sel_regiao").val()].includes(b.location)}),"total_cases"),a=$("#regiao_casos").highcharts();for(;0<a.series.length;)a.series[0].remove(!1);for(i=0;i<e.length;i++)a.addSeries({name:e[i].name,data:e[i].data},!1);a.update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos - "+$("#sel_regiao").val()},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}}});let b=formatToChart(estados.filter(function(b){return regioes[$("#sel_regiao").val()].includes(b.location)}),"total_deaths"),c=$("#regiao_obitos").highcharts();for(;0<c.series.length;)c.series[0].remove(!1);for(i=0;i<b.length;i++)c.addSeries({name:b[i].name,data:b[i].data},!1);c.update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos - "+$("#sel_regiao").val()},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}}})}),$("#sel_regiao").change();let u=formatToChart(alignData(estados,"total_cases","day"),"total_cases","day");for(createLineChart("estados_comp"),i=0;i<u.length;i++)$("#estados_comp").highcharts().addSeries({name:u[i].name,data:u[i].data},!1);$("#estados_comp").highcharts().update({yAxis:{type:"logarithmic",min:100,title:{text:"Casos confirmados"}},xAxis:{type:"linear",tickInterval:1,labels:{rotation:0},title:{text:"Dia"}},title:{text:"Casos confirmados ap\xF3s o 100\xBA caso"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}},tooltip:{formatter:function(){var b="<small>Dia "+this.x+"</small>";return $.each(this.points,function(){b+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b>",b+=" <small>("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</small>"}),b}},exporting:{buttons:{customButton:{text:"Linear"}}}});let w=formatToColumnChart(getLastDate2(estados).filter(function(b){return 20<=b.total_deaths}),"location","CFR");createColumnChart("estados_CFR","123"),$("#estados_CFR").highcharts().addSeries({data:w.series[0].data},!1),$("#estados_CFR").highcharts().update({chart:{marginTop:70},title:{text:"Letalidade por estado"},xAxis:{crosshair:!0,categories:w.order},yAxis:{title:{text:"Letalidade"},labels:{format:"{value}%"}},tooltip:{formatter:function(){var d=this.points[0].point.name,a=this.points[0].point.deaths,b=this.points[0].point.cases;return"<small>"+d+":</small><br><b>"+this.y+"%</b> ("+a+" \xF3bitos / "+b+" casos)"}},subtitle:{text:"Como o valor da letalidade varia muito quando h\xE1 poucos casos, s\xF3 s\xE3o representados neste gr\xE1fico estados em que ocorreram ao menos 20 \xF3bitos",align:"left",y:30,margin:0}});let x=formatToChart(worldData,"total_cases","day_cases");createLineChart("world_comp");var y=$("#world_comp").highcharts();$("#sel_country").select2(),$("#sel_country").on("select2:select",function(d){var a=d.params.data.element,b=$(a);b.detach(),$(this).append(b),$(this).select2("close"),$(this).trigger("change")});let z=[...new Set(worldData.map(b=>b.location))];for(z.forEach(function(b){$("#sel_country").append(new Option(b,b))}),$("#sel_country").val(worldCompare),$("#sel_country").change(function(){let c=$("#sel_country").val();for(;0<y.series.length;)y.series[0].remove(!1);for(i=0;i<c.length;i++){let a=x.filter(function(a){return a.name==c[i]})[0];y.addSeries({name:a.name,data:a.data},!1)}for(y.redraw();0<B.series.length;)B.series[0].remove(!1);for(i=0;i<c.length;i++){let a=x.filter(function(a){return a.name==c[i]})[0];B.addSeries({name:a.name,data:a.data},!1)}for(B.redraw(),C=getLastDate2(worldData).filter(function(a){return c.includes(a.location)||"World"==a.location}),M=formatToColumnChart(C,"location","CFR"),$("#world_CFR").highcharts().series[0].remove(!1),$("#world_CFR").highcharts().addSeries({data:M.series[0].data},!1),$("#world_CFR").highcharts().update({title:{text:"Letalidade em diferentes pa\xEDses"},xAxis:{crosshair:!0,categories:M.order}});0<$("#world_CFR_comp").highcharts().series.length;)$("#world_CFR_comp").highcharts().series[0].remove(!1);for(i=0;i<c.length;i++){let a=N.filter(function(a){return a.name==c[i]})[0];$("#world_CFR_comp").highcharts().addSeries({name:a.name,data:a.data},!1)}$("#world_CFR_comp").highcharts().redraw()}),i=0;i<worldCompare.length;i++){let b=x.filter(function(b){return b.name==worldCompare[i]})[0];y.addSeries({name:b.name,data:b.data},!1)}y.update({yAxis:{title:{text:"Casos confirmados"},min:100,type:"logarithmic"},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"},min:1},title:{text:"Casos confirmados ap\xF3s o 100\xBA caso"},caption:{text:"Fonte: Our World in Data"},legend:{enabled:!0},tooltip:{formatter:function(){var b="<small>Dia "+this.x+"</small>";return $.each(this.points,function(){b+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b>",b+=" <small>("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</small>"}),b}},exporting:{buttons:{customButton:{text:"Linear"}}}});let A=formatToChart(worldData,"total_deaths","day_deaths");createLineChart("world_comp_obitos");var B=$("#world_comp_obitos").highcharts();for(i=0;i<worldCompare.length;i++){let b=A.filter(function(b){return b.name==worldCompare[i]})[0];B.addSeries({name:b.name,data:b.data},!1)}B.update({yAxis:{title:{text:"\xD3bitos"},min:100,type:"logarithmic"},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"},min:1},title:{text:"\xD3bitos ap\xF3s o 100\xBA \xF3bito"},caption:{text:"Fonte: Our World in Data"},legend:{enabled:!0},tooltip:{formatter:function(){var b="<small>Dia "+this.x+"</small>";return $.each(this.points,function(){b+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b>",b+=" <small>("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</small>"}),b}},exporting:{buttons:{customButton:{text:"Linear"}}}});let C=getLastDate2(worldData).filter(function(b){return worldCompare.includes(b.location)||"World"==b.location}),M=formatToColumnChart(C,"location","CFR");createColumnChart("world_CFR"),$("#world_CFR").highcharts().addSeries({data:M.series[0].data},!1),$("#world_CFR").highcharts().update({title:{text:"Letalidade em diferentes pa\xEDses"},xAxis:{crosshair:!0,categories:M.order},yAxis:{title:{text:"Letalidade"},labels:{format:"{value}%"}},tooltip:{formatter:function(){var d=this.points[0].point.name,a=this.points[0].point.deaths,b=this.points[0].point.cases;return"<small>"+d+":</small><br><b>"+this.y+"%</b> ("+a+" \xF3bitos / "+b+" casos)"}},subtitle:{text:"Apenas alguns pa\xEDses que tem sido comparados ao Brasil s\xE3o representados neste gr\xE1fico. Diversos pa\xEDses possuem letalidade nesta faixa, mas n\xE3o s\xE3o mostrados.<br>A coluna 'Mundo' representa a m\xE9dia pelo n\xFAmero total de casos e \xF3bitos, e n\xE3o a m\xE9dia das letalidades de todos pa\xEDses."},caption:{text:"Fonte: Our World in Data"}});let N=formatToChart(worldData,"CFR","day_deaths");for(createLineChart("world_CFR_comp"),i=0;i<worldCompare.length;i++){let b=N.filter(function(b){return b.name==worldCompare[i]})[0];$("#world_CFR_comp").highcharts().addSeries({name:b.name,data:b.data},!1)}$("#world_CFR_comp").highcharts().update({chart:{marginTop:50},yAxis:{title:{text:"Varia\xE7\xE3o da letalidade"},labels:{format:"{value}%"}},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"}},title:{text:"Compara\xE7\xE3o da evolu\xE7\xE3o da taxa letalidade"},subtitle:{text:"A partir do 100\xBA \xF3bito"},legend:{enabled:!0},tooltip:{shared:!0,formatter:function(){var b="<small>Dia "+this.x+"</small>";return $.each(this.points,function(){b+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+this.y+"%</b>",b+=" <small>("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</small>"}),b}},caption:{text:"Fonte: Our World in Data"},exporting:{buttons:{customButton:{enabled:!1}}}}),console.log("Time to generate HS plots: "+(new Date().getTime()-starttimeHS)+"ms"),$("#loading, #wall").hide()}document.addEventListener("DOMContentLoaded",function(){$("#sel_estado").select2(),nomesEstados.forEach(function(b){$("#sel_estado").append(new Option(b,b))}),$("#sel_estado").val("Distrito Federal"),["Sudeste","Centro-Oeste","Nordeste","Sul","Norte"].forEach(function(b){$("#sel_regiao").append(new Option(b,b))}),starttimeW=new Date().getTime(),fetch(worldDataSource).then(function(b){b.text().then(function(b){rawWorldData=b,parseWorldData()})}),$.ajaxSetup({headers:{"x-parse-application-id":"unAFkcaNDeXajurGB7LChj8SgQYS2ptm"},error:function(){console.log("Erro (GET request failed): falha ao carregar dados do Minist\xE9rio da Sa\xFAde, utilizando dados em cache."),parseBrasilData(!1)}}),starttimeBR=new Date().getTime(),$.get(msGetURL,function(b){brasilDataSource=b.results[0].arquivo.url,"file:"==window.location.protocol?(console.log("Running locally and ignoring MS data."),parseBrasilData(!1)):fetch(brasilDataSource).then(function(b){b.text().then(function(b){rawBrasilData=b.replace("date","date").replace("sigla","location").replace("casosNovos","new_cases").replace("casosAcumulados","total_cases").replace("obitosNovos","new_deaths").replace("obitosAcumulados","total_deaths"),parseBrasilData(!0)})}).catch(function(){console.log("Erro (file request failed): Falha ao carregar dados do Minist\xE9rio da Sa\xFAde, utilizando dados em cache."),parseBrasilData(!1)})},"json")});
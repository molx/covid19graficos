var starttimeBR,starttimeW,starttimeHS;function dateToDM(t){var e=t.getDate(),a=t.getMonth()+1;return""+(9>=e?"0"+e:e)+"/"+(9>=a?"0"+a:a)}function numberWithSep(t){return 999<t?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."):t.toString().replace(".",",")}function isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}function splat(t){return isArray(t)?t:[t]}function matchStart(t,e){return t.term=t.term||"",0==e.text.toUpperCase().indexOf(t.term.toUpperCase())&&e}function formatToChart(t,e,a="date"){const o=[...new Set(t.map(t=>t.location))];let s=[];return o.forEach(function(o){let r,d=t.filter(function(t){return t.location==o}),l=[],n=!0;d.forEach(function(t){(t[e]||!n)&&(n=!1,r={},r.x="date"==a?Date.parse(t[a]):t[a],r.y=t[e],Object.keys(t).map(e=>r[e]=t[e]),l.push(r))}),s.push({name:o,data:l})}),s}function formatToColumnChart(t,e,o){let s=[{data:[]}];const r=Object.values(t).reduce((t,e)=>+t+e[o],0);for(i=0;i<t.length;i++)if("CFR"==o)s[0].data.push({name:t[i][e],y:t[i][o],color:myColors[i],deaths:t[i].total_deaths,cases:t[i].total_cases});else{let a=Math.round(10000*t[i][o]/r)/100;s[0].data.push({name:t[i][e],y:t[i][o],color:myColors[i],pct:a})}s[0].data.sort((t,e)=>parseFloat(e.y)-parseFloat(t.y));let d=[...new Set(s[0].data.map(t=>t.name))];return{series:s,order:d}}function formatDBLInterval(t){const e=[...new Set(t.map(t=>t.location))];let a=[];return e.forEach(function(e){let o,s=t.filter(function(t){return t.location==e}),r=[];s.forEach(function(t){o={x:Date.parse(t.date),low:t.dbl_time_lwr,high:t.dbl_time_upr},Object.keys(t).map(e=>o[e]=t[e]),r.push(o)}),a.push({name:e,data:r})}),a}function summarise(t,e,a,o,s,r=!1){isArray(a)||(a=[a]);var d=[];for(v=0;v<a.length;v++){d[a[v]]||(d[a[v]]={});for(let o=0;o<t.length;o++)d[a[v]][t[o][e]]?d[a[v]][t[o][e]]+=t[o][a[v]]:d[a[v]][t[o][e]]=t[o][a[v]]}var l={},n=[];for(i=0;i<Object.keys(d[a[0]]).length;i++){let t=Object.assign({},l),c=Object.keys(d[a[0]])[i];for(t[e]=c,t[o]=s,v=0;v<a.length;v++)t[a[v]]=r?0<i?Math.round(10000*(d[a[v]][c]-d[a[v]][Object.keys(d[a[v]])[i-1]])/d[a[v]][Object.keys(d[a[v]])[i-1]])/100:0:d[a[v]][c];n.push(t)}return n}function alignData(t,e,a){var o=[],s=[];for(i=0;i<t.length;i++)100<=t[i][e]&&o.push(t[i]);o.sort((t,e)=>t.location>e.location?1:e.location>t.location?-1:0);let r=o[0].location;for(s.push(o[0]),s[0][a]=1,i=1;i<o.length;i++)o[i].location==r?(s.push(o[i]),s[i][a]=s[i-1][a]+1):(s.push(o[i]),s[i][a]=1,r=o[i].location);return s}function getLastDate2(t){let e=t[t.length-1].date.getTime(),a=t.filter(function(t){return t.date.getTime()==e});return a}function getCFR(t,e=!0){let a=[];for(Object.assign(a,t),e&&(a=getLastDate(a)),i=0;i<a.length;i++)a[i].CFR=Math.round(10000*a[i].total_deaths/a[i].total_cases)/100,a[i].CFR=isNaN(a[i].CFR)?0:a[i].CFR;let o=a.filter(function(t){return 20<=t.total_deaths});return o}function daysToMs(t){return 1e3*(3600*(24*t))}var regioes={Sudeste:["S\xE3o Paulo","Rio de Janeiro","Minas Gerais","Esp\xEDrito Santo"],"Centro-Oeste":["Distrito Federal","Goi\xE1s","Mato Grosso","Mato Grosso do Sul"],Nordeste:["Maranh\xE3o","Piau\xED","Cear\xE1","Rio Grande do Norte","Para\xEDba","Pernambuco","Alagoas","Sergipe","Bahia"],Sul:["Paran\xE1","Santa Catarina","Rio Grande do Sul"],Norte:["Acre","Amazonas","Par\xE1","Rond\xF4nia","Roraima","Amap\xE1","Tocantins"]},acronyms={Acre:"AC",Alagoas:"AL",Amazonas:"AM",Bahia:"BA",Ceará:"CE","Distrito Federal":"DF","Espírito Santo":"ES",Goiás:"GO",Amapá:"AP",Maranhão:"MA","Mato Grosso":"MT","Mato Grosso do Sul":"MS","Minas Gerais":"MG",Paraná:"PR",Paraíba:"PB",Pará:"PA",Pernambuco:"PE",Piauí:"PI","Rio Grande do Norte":"RN","Rio Grande do Sul":"RS","Rio de Janeiro":"RJ",Rondônia:"RO",Roraima:"RR","Santa Catarina":"SC",Sergipe:"SE","São Paulo":"SP",Tocantins:"TO"},nomesEstados=Object.keys(acronyms).sort();regioes.Brasil=nomesEstados;var myColors=["#2b547e"].concat(palette("mpn65",26).map(t=>"#"+t)),highchartsOptions=Highcharts.setOptions({lang:{loading:"Aguarde...",months:["Janeiro","Fevereiro","Mar\xE7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdays:["Domingo","Segunda","Ter\xE7a","Quarta","Quinta","Sexta","S\xE1bado"],shortMonths:["Jan","Feb","Mar","Abr","Maio","Jun","Jul","Ago","Set","Out","Nov","Dez"],viewFullscreen:"Ver em tela cheia",exitFullscreen:"Sair da tela cheia",printChart:"Imprimir",rangeSelectorFrom:"De",rangeSelectorTo:"At\xE9",rangeSelectorZoom:"Periodo",downloadPNG:"Download imagem PNG",downloadJPEG:"Download imagem JPEG",downloadPDF:"Download documento PDF",downloadSVG:"Download imagem SVG",numericSymbols:null,thousandsSep:".",resetZoom:"Resetar zoom"},chart:{spacingBottom:16,zoomType:"x",resetZoomButton:{position:{x:-150,y:10},relativeTo:"chart",theme:{height:14}},panning:!0,panKey:"ctrl"},yAxis:{endOnTick:!1},title:{align:"left"},subtitle:{align:"left",y:30,margin:0},caption:{useHTML:!0,text:"<a href=\"https://covid.saude.gov.br/\" target=\"_blank\">Fonte: Minist\xE9rio da Sa\xFAde</a>",margin:0,y:25},credits:{text:"covid19graficos.com.br",href:"http://covid19graficos.com.br",position:{x:-12}},colors:myColors});function changeType(t,e){t.yAxis[0].isLog?(t.yAxis[0].update({type:"linear"},!1,!1,!1),t.exportSVGElements[2].attr({text:"Logar\xEDtmica"})):(t.yAxis[0].update({type:"logarithmic"},!1,!1,!1),t.exportSVGElements[2].attr({text:"Linear"})),t.redraw(e)}function createLineChart(t){Highcharts.chart({chart:{renderTo:t,type:"line",styledMode:!1},data:{dateFormat:"YYYY-mm-dd"},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%d/%m"},tickInterval:daysToMs(1),labels:{rotation:-45}},yAxis:{min:1,labels:{format:"{value:,.0f}"}},legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!0,radius:3}}},tooltip:{crosshairs:!0,shared:!0,dateTimeLabelFormats:{day:"%A, %d/%m/%Y"},outside:!0,formatter:function(t){var e=this.points||splat(this),a=e[0].series;return e.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0}),t.defaultFormatter.call(this,t)}},defs:{custombtn:{tagName:"pattern",id:"custom-btn-bg",width:100}},exporting:{buttons:{customButton:{text:"Logar\xEDtmica",id:"btn",onclick:function(){changeType(this,!0)},theme:{width:70,"text-align":"center",stroke:"#000",r:6}}}}})}function createColumnChart(t,e=null){Highcharts.chart(t,{chart:{type:"column"},plotOptions:{series:{groupPadding:0,colorByPoint:!1}},tooltip:{shared:!0,formatter:function(){var t,a=this.point,o=this.series;return t=this.points[0].point.pct,name=this.points[0].point.name,"<span style=\"font-size: 10px\">"+name+"</span>:<br><b>"+this.y+"</b> ("+t+"% dos "+e+")"}},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!1,labelFormatter:function(){return acronyms[this.name]}}})}function createTimeColumnChart(t){Highcharts.chart(t,{chart:{type:"column"},plotOptions:{series:{groupPadding:0,colorByPoint:!1}},data:{dateFormat:"YYYY-mm-dd"},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%d/%m"},tickInterval:daysToMs(1),labels:{rotation:-45}},tooltip:{crosshairs:!0,shared:!0,dateTimeLabelFormats:{day:"%A, %d/%m/%Y"},outside:!0},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!1,labelFormatter:function(){return acronyms[this.name]}}})}const msGetURL="https://xx9p7hp1p7.execute-api.us-east-1.amazonaws.com/prod/PortalGeral";let brasilDataSource,rawBrasilData,brasilData;var loadedBrasilData=!1,loadedWorldData=!1;function parseBrasilData(t){if(console.log("Time to download Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),t){parsedData=Papa.parse(rawBrasilData,{header:!0,dynamicTyping:!0,skipEmptyLines:!0}).data,console.log("Time to parse Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime();let t=Object.values(parsedData[0]),e="string"==typeof t[2]&&3==t[2].split("/").length,a=Object.keys(parsedData[0]);if(refCols=["date","location","new_cases","total_cases","new_deaths","total_deaths"],!e)console.log("Succesfully fetched MS data but date column is invalid, using manual data instead.");else if(!refCols.every(t=>a.includes(t)))console.log("Succesfully fetched MS data but at least one column is missing or misnamed.");else{parsedData.map(t=>t.date=t.date.split("/").reverse().join("-")),parsedData.map(t=>t.location=Object.keys(acronyms).find(e=>acronyms[e]===t.location));let t=new Date(estados[estados.length-1].date).getTime(),e=new Date(parsedData[parsedData.length-1].date).getTime();e>=t?(console.log("Succesfully fetched MS data."),estados=parsedData):console.log("Succesfully fetched MS data but file is outdated or corrupted, using manual data instead.")}}console.log("Time to check Brasil MS data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),brasilData=summarise(estados,"date",["total_cases","total_deaths","new_cases","new_deaths"],"location","Brasil"),console.log("Time to summarise Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),starttimeBR=new Date().getTime(),brasilData=addColumns(brasilData),estados=addColumns(estados),loadedBrasilData=!0,console.log("Time to process Brasil data: "+(new Date().getTime()-starttimeBR)+"ms"),loadedWorldData&&(generatePlots(),loadedBrasilData=!1)}let rawWorldData,worldData;const worldDataSource="https://covid.ourworldindata.org/data/ecdc/full_data.csv",worldCompare=["Brasil","It\xE1lia","Estados Unidos","Espanha","Alemanha","Reino Unido","Coreia do Sul"];function parseWorldData(){console.log("Time to download World data: "+(new Date().getTime()-starttimeW)+"ms"),starttimeW=new Date().getTime(),worldData=Papa.parse(rawWorldData,{header:!0,dynamicTyping:!0,skipEmptyLines:!0}).data,console.log("Time to parse World data: "+(new Date().getTime()-starttimeW)+"ms"),starttimeW=new Date().getTime(),worldData.map(t=>t.location=worldTrad[t.location]?worldTrad[t.location]:t.location),worldData=addColumns(worldData,!1),loadedWorldData=!0,console.log("Time to process World data: "+(new Date().getTime()-starttimeW)+"ms"),loadedBrasilData&&(generatePlots(),loadedWorldData=!1)}function addColumns(t,e=!1){let a=86400000,o=[];t.map(t=>t.date=new Date(t.date)),e&&t.map(t=>t.date.setDate(t.date.getDate()-1));let s=[...new Set(t.map(t=>t.location))];for(i=0;i<s.length;i++){let e=1/0,r=1/0,d=t.filter(t=>t.location==s[i]);for(d[0].change_cases=0,d[0].change_deaths=0,j=1;j<d.length;j++)d[j].change_cases=Math.round(10000*d[j].new_cases/d[j-1].total_cases)/100,d[j].change_deaths=Math.round(10000*d[j].new_deaths/d[j-1].total_deaths)/100,e==1/0&&100<=d[j].total_cases&&(e=d[j].date),r==1/0&&100<=d[j].total_deaths&&(r=d[j].date),d[j].day_cases=(d[j].date-e)/a+1,d[j].day_deaths=(d[j].date-r)/a+1,d[j].CFR=Math.round(10000*d[j].total_deaths/d[j].total_cases)/100;o=o.concat(d)}return o}function addColumns2(t){let e=86400000;t.map(t=>t.date=new Date(t.date));let a=[...new Set(t.map(t=>t.location))],o={},s={};for(i=0;i<a.length;i++){let e=t.find(t=>t.location==a[i]&&100<=t.total_cases);o[a[i]]=e?e.date:1/0;let r=t.find(t=>t.location==a[i]&&100<=t.total_deaths);s[a[i]]=r?r.date:1/0}for(i=0;i<t.length;i++){let a=t.find(a=>t[i].location==a.location&&t[i].date.getTime()-a.date.getTime()==e);a?(t[i].change_cases=Math.round(10000*t[i].new_cases/a.total_cases)/100,t[i].change_deaths=Math.round(10000*t[i].new_deaths/a.total_deaths)/100,t[i].change_cases=isNaN(t[i].change_cases)?0:t[i].change_cases,t[i].change_deaths=isNaN(t[i].change_deaths)?0:t[i].change_deaths):(t[i].change_cases=0,t[i].change_deaths=0),t[i].day_cases=(t[i].date-o[t[i].location])/e+1,t[i].day_deaths=(t[i].date-s[t[i].location])/e+1,t[i].CFR=Math.round(10000*t[i].total_deaths/t[i].total_cases)/100,t[i].CFR=isNaN(t[i].CFR)?0:t[i].CFR}return t}function pad(t){return 10>t?"0"+t:t}function generatePlots(){function t(t){for(;0<$("#world_DBL").highcharts().series.length;)$("#world_DBL").highcharts().series[0].remove(!1);for(i=0;i<t.length;i++){let e=I.find(function(e){return e.name==t[i]});if($("#world_DBL").highcharts().addSeries({name:e.name,data:e.data},!1),O){let e=N.find(function(e){return e.name==t[i]});$("#world_DBL").highcharts().addSeries({name:"IC",data:e.data,type:"arearange",lineWidth:0,fillOpacity:.2,zIndex:0,linkedTo:":previous",marker:{enabled:!1},color:myColors[i]},!1)}}$("#world_DBL").highcharts().redraw()}starttimeHS=new Date().getTime();var e=brasilData[brasilData.length-1].total_cases,a=brasilData[brasilData.length-1].total_deaths,o=Math.round(10000*a/e)/100,s=brasilData[brasilData.length-1].date,r=pad(s.getUTCDate())+"/"+pad(s.getUTCMonth()+1)+"/"+s.getUTCFullYear();$("#data_br_dia").html(r),$("#data_br_casos").html(numberWithSep(e)),$("#data_br_obitos").html(numberWithSep(a)),$("#data_br_CFR").html(o.toString().replace(".",",")+"%"),createLineChart("br_casos"),$("#br_casos").highcharts().addSeries({name:"Total de casos",data:formatToChart(brasilData,"total_cases")[0].data},!1),$("#br_casos").highcharts().update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos confirmados"}}),createLineChart("br_obitos"),$("#br_obitos").highcharts().addSeries({name:"Total de \xF3bitos",data:formatToChart(brasilData,"total_deaths")[0].data},!1),$("#br_obitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos"}}),createTimeColumnChart("br_novoscasos"),$("#br_novoscasos").highcharts().addSeries({name:"Novos casos",yAxis:0,data:formatToChart(brasilData,"new_cases")[0].data},!1),$("#br_novoscasos").highcharts().update({yAxis:{title:{text:"Novos casos",style:{color:myColors[0]}},labels:{style:{color:myColors[0]}},min:0},title:{text:"Novos casos"},exporting:{buttons:{customButton:{enabled:!1}}}},!1),$("#br_novoscasos").highcharts().addAxis({title:{text:"Varia\xE7\xE3o em rela\xE7\xE3o ao dia anterior",style:{color:myColors[1]}},min:0,max:100,opposite:!0,labels:{format:"{value}%",style:{color:myColors[1]}}},!1),$("#br_novoscasos").highcharts().addSeries({name:"Aumento",yAxis:1,type:"line",marker:{enabled:!1},data:formatToChart(brasilData,"change_cases")[0].data,tooltip:{valueSuffix:"%"}},!0),createTimeColumnChart("br_novosobitos"),$("#br_novosobitos").highcharts().addSeries({name:"Novos \xF3bitos",data:formatToChart(brasilData,"new_deaths")[0].data},!1),$("#br_novosobitos").highcharts().update({yAxis:{title:{text:"Novos \xF3bitos",style:{color:myColors[0]}},labels:{style:{color:myColors[0]}},min:0},title:{text:"Novos \xF3bitos"},exporting:{buttons:{customButton:{enabled:!1}}}},!1),$("#br_novosobitos").highcharts().addAxis({title:{text:"Varia\xE7\xE3o em rela\xE7\xE3o ao dia anterior",style:{color:myColors[1]}},min:0,max:100,opposite:!0,labels:{format:"{value}%",style:{color:myColors[1]}}},!1),$("#br_novosobitos").highcharts().addSeries({name:"Aumento",yAxis:1,type:"line",marker:{enabled:!1},data:formatToChart(brasilData,"change_deaths")[0].data,tooltip:{valueSuffix:"%"}},!0);let d=formatToChart(brasilData,"CFR","date");createLineChart("br_CFR"),$("#br_CFR").highcharts().addSeries({name:"Taxa de letalidade",data:d[0].data},!1),$("#br_CFR").highcharts().update({chart:{marginTop:50},yAxis:{title:{text:"Varia\xE7\xE3o da letalidade"},labels:{format:"{value}%"}},title:{text:"Letalidade"},subtitle:{text:"A partir do 20\xBA \xF3bito"},tooltip:{shared:!1,valueSuffix:"%"},exporting:{buttons:{customButton:{enabled:!1}}}});let l=formatToChart(dbl_time_br.filter(t=>"Brasil"==t.location),"dbl_time","date"),n=formatDBLInterval(dbl_time_br.filter(t=>"Brasil"==t.location),"dbl_time","date");createLineChart("br_DBL"),$("#br_DBL").highcharts().addSeries({name:"Tempo de duplica\xE7\xE3o",data:l[0].data},!1),$("#br_DBL").highcharts().addSeries({name:"Intervalo de Confian\xE7a",data:n[0].data,type:"arearange",lineWidth:0,fillOpacity:.2,zIndex:0,linkedTo:":previous",marker:{enabled:!1},color:myColors[0]},!1),$("#br_DBL").highcharts().update({chart:{marginTop:65},yAxis:{title:{text:"Tempo de duplica\xE7\xE3o (dias)"},min:2,tickInterval:1},title:{text:"Tempo de duplica\xE7\xE3o*"},subtitle:{text:"Calculado com base nos \xF3bitos dos \xFAltimos 5 dias. O intervalo de confian\xE7a tem n\xEDvel de confian\xE7a de 95%."},tooltip:{shared:!0,valueSuffix:" dias"},exporting:{buttons:{customButton:{enabled:!1}}}});let c=formatToColumnChart(getLastDate2(estados),"location","total_cases"),h=jQuery.extend(!0,{},c);for(i=0;i<h.series[0].data.length;i++){var m=h.series[0].data[i];m.y=Math.round(100000000*m.y/populacao[0][m.name])/100}h.series[0].data.sort((t,e)=>parseFloat(e.y)-parseFloat(t.y)),h.order=[...new Set(h.series[0].data.map(t=>t.name))],createColumnChart("estados_dist","casos"),$("#estados_dist").highcharts().addSeries({data:formatToColumnChart(getLastDate2(estados),"location","total_cases").series[0].data},!1),$("#estados_dist").highcharts().update({title:{text:"Distribui\xE7\xE3o de casos por estado"},xAxis:{crosshair:!0,categories:c.order,labels:{style:{fontSize:"9px"}}},yAxis:{title:{text:"Casos confirmados"}},exporting:{buttons:{customButton:{text:"Por Habitantes",onclick:function(){"Por Habitantes"==this.exportSVGElements[2].text.textStr?(this.series[0].update({data:h.series[0].data},!1),this.xAxis[0].setCategories(h.order,!1),this.yAxis[0].setTitle({text:"Casos por milh\xE3o de habitantes"}),this.exportSVGElements[2].attr({text:"Total"})):(this.series[0].update({data:c.series[0].data},!1),this.xAxis[0].setCategories(c.order,!1),this.yAxis[0].setTitle({text:"Casos confirmados"}),this.exportSVGElements[2].attr({text:"Por Habitantes"}))},theme:{stroke:"#000",r:6,width:80,"text-align":"center"}}}}});let p=formatToColumnChart(getLastDate2(estados),"location","total_deaths"),g=jQuery.extend(!0,{},p);for(i=0;i<g.series[0].data.length;i++){var m=g.series[0].data[i];m.y=Math.round(100000000*m.y/populacao[0][m.name])/100}g.series[0].data.sort((t,e)=>parseFloat(e.y)-parseFloat(t.y)),g.order=[...new Set(g.series[0].data.map(t=>t.name))],createColumnChart("estados_dist_obitos","\xF3bitos"),$("#estados_dist_obitos").highcharts().addSeries({data:formatToColumnChart(getLastDate2(estados),"location","total_deaths").series[0].data},!1),$("#estados_dist_obitos").highcharts().update({title:{text:"Distribui\xE7\xE3o de \xF3bitos por estado"},xAxis:{crosshair:!0,categories:p.order,labels:{style:{fontSize:"9px"}}},yAxis:{title:{text:"\xD3bitos"}},exporting:{buttons:{customButton:{text:"Por Habitantes",onclick:function(){"Por Habitantes"==this.exportSVGElements[2].text.textStr?(this.series[0].update({data:g.series[0].data},!1),this.xAxis[0].setCategories(g.order,!1),this.yAxis[0].setTitle({text:"\xD3bitos por milh\xE3o de habitantes"}),this.exportSVGElements[2].attr({text:"Total"})):(this.series[0].update({data:p.series[0].data},!1),this.xAxis[0].setCategories(p.order,!1),this.yAxis[0].setTitle({text:"\xD3bitos"}),this.exportSVGElements[2].attr({text:"Por Habitantes"}))},theme:{stroke:"#000",r:6,width:80,"text-align":"center"}}}}});let u=formatToColumnChart(getLastDate2(estados).filter(function(t){return 20<=t.total_deaths}),"location","CFR");createColumnChart("estados_CFR"),$("#estados_CFR").highcharts().addSeries({data:u.series[0].data},!1),$("#estados_CFR").highcharts().update({chart:{marginTop:70},title:{text:"Letalidade por estado"},xAxis:{crosshair:!0,categories:u.order},yAxis:{title:{text:"Letalidade"},labels:{format:"{value}%"}},tooltip:{formatter:function(){var t=this.points[0].point.name,e=this.points[0].point.deaths,a=this.points[0].point.cases;return"<span style=\"font-size: 10px\">"+t+":</span><br><b>"+numberWithSep(this.y)+"%</b> ("+numberWithSep(e)+" \xF3bitos / "+numberWithSep(a)+" casos)"}},subtitle:{text:"Como o valor da letalidade varia muito quando h\xE1 poucos casos, s\xF3 s\xE3o representados neste gr\xE1fico estados em que ocorreram ao menos 20 \xF3bitos",align:"left",y:30,margin:0}});var _=estados.filter(function(t){return t.location==$("#sel_estado").val()}),b=_[_.length-1].total_cases,x=_[_.length-1].total_deaths,y=Math.round(10000*x/b)/100;$("#data_estado_casos").html(numberWithSep(b)),$("#data_estado_obitos").html(numberWithSep(x)),$("#data_estado_CFR").html(y.toString().replace(".",",")+"%"),$("#sel_estado").change(function(){_=estados.filter(function(t){return t.location==$("#sel_estado").val()}),b=_[_.length-1].total_cases,x=_[_.length-1].total_deaths,y=Math.round(10000*x/b)/100,$("#data_estado_casos").html(numberWithSep(b)),$("#data_estado_obitos").html(numberWithSep(x)),$("#data_estado_CFR").html(y.toString().replace(".",",")+"%");let t=$("#estado_casos").highcharts();t.series[0].update({name:$("#sel_estado").val(),data:formatToChart(_,"total_cases")[0].data},!1),t.setTitle({text:"Casos confirmados - "+$("#sel_estado").val()});let e=$("#estado_obitos").highcharts();e.series[0].update({name:$("#sel_estado").val(),data:formatToChart(_,"total_deaths")[0].data},!1),e.setTitle({text:"\xD3bitos - "+$("#sel_estado").val()});let a=$("#estado_novoscasos").highcharts();a.series[0].update({name:$("#sel_estado").val(),data:formatToChart(_,"new_cases")[0].data},!1),a.setTitle({text:"Novos casos - "+$("#sel_estado").val()});let o=$("#estado_novosobitos").highcharts();o.series[0].update({name:$("#sel_estado").val(),data:formatToChart(_,"new_deaths")[0].data},!1),o.setTitle({text:"Novos \xF3bitos - "+$("#sel_estado").val()});let s=$("#estado_DBL").highcharts(),r=formatToChart(dbl_time_br.filter(t=>t.location==$("#sel_estado").val()),"dbl_time","date")[0],d=formatDBLInterval(dbl_time_br.filter(t=>t.location==$("#sel_estado").val()),"dbl_time","date")[0],l="Calculado com base nos \xF3bitos dos \xFAltimos 5 dias. O intervalo de confian\xE7a tem n\xEDvel de confian\xE7a de 95%.";r||(r={},d={},r.data=[0],d.data=[0],l="N\xE3o h\xE1 dados suficientes para o c\xE1lculo do tempo de duplica\xE7\xE3o."),s.series[0].update({name:"Tempo de duplica\xE7\xE3o",data:r.data},!1),s.series[1].update({name:"Intervalo de Confian\xE7a",data:d.data},!1),s.update({subtitle:{text:l}},!1),t.redraw(),e.redraw(),a.redraw(),o.redraw(),s.redraw()}),createLineChart("estado_casos"),$("#estado_casos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(_,"total_cases")[0].data},!1),$("#estado_casos").highcharts().update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos confirmados - "+$("#sel_estado").val()}}),createLineChart("estado_obitos"),$("#estado_obitos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(_,"total_deaths")[0].data},!1),$("#estado_obitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos - "+$("#sel_estado").val()}}),createTimeColumnChart("estado_novoscasos"),$("#estado_novoscasos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(_,"new_cases")[0].data},!1),$("#estado_novoscasos").highcharts().update({yAxis:{title:{text:"Novos casos"},min:0},title:{text:"Novos casos - "+$("#sel_estado").val()},exporting:{buttons:{customButton:{enabled:!1}}}},!0),createTimeColumnChart("estado_novosobitos"),$("#estado_novosobitos").highcharts().addSeries({name:$("#sel_estado").val(),data:formatToChart(_,"new_deaths")[0].data},!1),$("#estado_novosobitos").highcharts().update({yAxis:{title:{text:"\xD3bitos"},min:0},title:{text:"Novos \xF3bitos - "+$("#sel_estado").val()},exporting:{buttons:{customButton:{enabled:!1}}}},!0);let f=formatToChart(dbl_time_br.filter(t=>t.location==$("#sel_estado").val()),"dbl_time","date"),S=formatDBLInterval(dbl_time_br.filter(t=>t.location==$("#sel_estado").val()),"dbl_time","date");createLineChart("estado_DBL"),$("#estado_DBL").highcharts().addSeries({name:"Tempo de duplica\xE7\xE3o",data:f[0]?f[0].data:[0]},!1),$("#estado_DBL").highcharts().addSeries({name:"Intervalo de Confian\xE7a",data:S[0]?S[0].data:[0],type:"arearange",lineWidth:0,fillOpacity:.2,zIndex:0,linkedTo:":previous",marker:{enabled:!1},color:myColors[0]},!1),$("#estado_DBL").highcharts().update({chart:{marginTop:65},yAxis:{title:{text:"Tempo de duplica\xE7\xE3o (dias)"},min:2,tickInterval:1},title:{text:"Tempo de duplica\xE7\xE3o"},subtitle:{text:"Calculado com base nos \xF3bitos dos \xFAltimos 5 dias. O intervalo de confian\xE7a tem n\xEDvel de confian\xE7a de 95%."},tooltip:{shared:!0,valueSuffix:" dias"},exporting:{buttons:{customButton:{enabled:!1}}}}),createLineChart("estados_casos");let A=formatToChart(estados,"total_cases"),T=$("#estados_casos").highcharts();for(;0<T.series.length;)T.series[0].remove(!1);for(i=0;i<A.length;i++)T.addSeries({name:A[i].name,data:A[i].data},!1);T.update({yAxis:{title:{text:"Casos confirmados"}},title:{text:"Casos - todos estados"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}},plotOptions:{line:{marker:{enabled:!1}}},exporting:{buttons:{customButton:{onclick:function(){changeType(this,!1)}}}}}),createLineChart("estados_obitos");let C=formatToChart(estados,"total_deaths"),w=$("#estados_obitos").highcharts();for(;0<w.series.length;)w.series[0].remove(!1);for(i=0;i<C.length;i++)w.addSeries({name:C[i].name,data:C[i].data},!1);w.update({yAxis:{title:{text:"\xD3bitos"}},title:{text:"\xD3bitos - todos estados"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}}});let F=formatToChart(alignData(estados,"total_cases","day"),"total_cases","day");for(createLineChart("estados_comp"),i=0;i<F.length;i++)$("#estados_comp").highcharts().addSeries({name:F[i].name,data:F[i].data},!1);$("#estados_comp").highcharts().update({yAxis:{type:"logarithmic",min:100,title:{text:"Casos confirmados"}},xAxis:{type:"linear",tickInterval:1,labels:{rotation:0},title:{text:"Dia"}},title:{text:"Casos confirmados ap\xF3s o 100\xBA caso"},legend:{align:"center",floating:!1,verticalAlign:"bottom",layout:"horizontal",enabled:!0,labelFormatter:function(){return acronyms[this.name]}},tooltip:{formatter:function(){var t="<span style=\"font-size: 10px\">Dia "+this.x+"</span>",e=this.points||splat(this);return e.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0}),$.each(this.points,function(){t+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b> ",t+=" <span style=\"font-size: 10px\">("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</span>"}),t}},exporting:{buttons:{customButton:{text:"Linear"}}}});let B=formatToChart(dbl_time_br.filter(t=>"Brasil"!=t.location),"dbl_time","date"),k=formatDBLInterval(dbl_time_br.filter(t=>"Brasil"!=t.location),"dbl_time","date");for(createLineChart("estados_DBL"),i=0;i<B.length;i++){let t=B[i];$("#estados_DBL").highcharts().addSeries({name:t.name,data:t.data},!1)}$("#estados_DBL").highcharts().update({chart:{marginTop:65},yAxis:{title:{text:"Tempo de duplica\xE7\xE3o (dias)"},min:2,tickInterval:1},title:{text:"Tempo de duplica\xE7\xE3o"},subtitle:{text:"Calculado com base nos \xF3bitos dos \xFAltimos 5 dias.<br>Os ICs se referem a um n\xEDvel de confian\xE7a de 95%."},tooltip:{shared:!0,formatter:function(){var t=this.points||splat(this);t.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0});var e="<span style=\"font-size: 10px\">"+Highcharts.dateFormat("%A, %d/%m/%Y",this.x)+"</span>";return $.each(t,function(){"IC"!=this.series.name&&(e+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b>",e+=" (IC: "+numberWithSep(this.point.dbl_time_lwr)+" - "+numberWithSep(this.point.dbl_time_upr)+") dias")}),e}},exporting:{buttons:{customButton:{enabled:!1}}},legend:{enabled:!0}});let R=formatToChart(worldData,"total_cases","day_cases");createLineChart("world_comp");var D=$("#world_comp").highcharts();$("#sel_country").select2({matcher:matchStart}),$("#sel_country").on("select2:select",function(t){var e=t.params.data.element,a=$(e);a.detach(),$(this).append(a),$(this).select2("close"),$(this).trigger("change")});let L=[...new Set(worldData.map(t=>t.location))];for(L.forEach(function(t){$("#sel_country").append(new Option(t,t))}),$("#sel_country").val(worldCompare),$("#sel_country").change(function(){let e=$("#sel_country").val();for(;0<D.series.length;)D.series[0].remove(!1);for(i=0;i<e.length;i++){let t=R.filter(function(t){return t.name==e[i]})[0];D.addSeries({name:t.name,data:t.data},!1)}for(D.redraw();0<P.series.length;)P.series[0].remove(!1);for(i=0;i<e.length;i++){let t=M.filter(function(t){return t.name==e[i]})[0];P.addSeries({name:t.name,data:t.data},!1)}for(P.redraw(),z=getLastDate2(worldData).filter(function(t){return e.includes(t.location)||"World"==t.location}),E=formatToColumnChart(z,"location","CFR"),$("#world_CFR").highcharts().series[0].remove(!1),$("#world_CFR").highcharts().addSeries({data:E.series[0].data},!1),$("#world_CFR").highcharts().update({title:{text:"Letalidade em diferentes pa\xEDses"},xAxis:{crosshair:!0,categories:E.order}});0<$("#world_CFR_comp").highcharts().series.length;)$("#world_CFR_comp").highcharts().series[0].remove(!1);for(i=0;i<e.length;i++){let t=G.filter(function(t){return t.name==e[i]})[0];$("#world_CFR_comp").highcharts().addSeries({name:t.name,data:t.data},!1)}$("#world_CFR_comp").highcharts().redraw(),t(e)}),i=0;i<worldCompare.length;i++){let t=R.filter(function(t){return t.name==worldCompare[i]})[0];D.addSeries({name:t.name,data:t.data},!1)}D.update({yAxis:{title:{text:"Casos confirmados"},min:100,type:"logarithmic"},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"},min:1},title:{text:"Casos confirmados ap\xF3s o 100\xBA caso"},caption:{useHTML:!0,text:"<a href=\"https://ourworldindata.org/coronavirus\" target=\"_blank\">Fonte: Our World in Data</a>"},legend:{enabled:!0},tooltip:{formatter:function(){var t="<span style=\"font-size: 10px\">Dia "+this.x+"</span>",e=this.points||splat(this);return e.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0}),$.each(this.points,function(){t+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b> ",t+=" <span style=\"font-size: 10px\">("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</span>"}),t}},exporting:{buttons:{customButton:{text:"Linear"}}}});let M=formatToChart(worldData,"total_deaths","day_deaths");createLineChart("world_comp_obitos");var P=$("#world_comp_obitos").highcharts();for(i=0;i<worldCompare.length;i++){let t=M.filter(function(t){return t.name==worldCompare[i]})[0];P.addSeries({name:t.name,data:t.data},!1)}P.update({yAxis:{title:{text:"\xD3bitos"},min:100,type:"logarithmic"},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"},min:1},title:{text:"\xD3bitos ap\xF3s o 100\xBA \xF3bito"},caption:{useHTML:!0,text:"<a href=\"https://ourworldindata.org/coronavirus\" target=\"_blank\">Fonte: Our World in Data</a>"},legend:{enabled:!0},tooltip:{formatter:function(){var t="<span style=\"font-size: 10px\">Dia "+this.x+"</span>",e=this.points||splat(this);return e.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0}),$.each(this.points,function(){t+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b> ",t+=" <span style=\"font-size: 10px\">("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</span>"}),t}},exporting:{buttons:{customButton:{text:"Linear"}}}});let z=getLastDate2(worldData).filter(function(t){return worldCompare.includes(t.location)||"World"==t.location}),E=formatToColumnChart(z,"location","CFR");createColumnChart("world_CFR"),$("#world_CFR").highcharts().addSeries({data:E.series[0].data},!1),$("#world_CFR").highcharts().update({title:{text:"Letalidade em diferentes pa\xEDses"},xAxis:{crosshair:!0,categories:E.order},yAxis:{title:{text:"Letalidade"},labels:{format:"{value}%"}},tooltip:{formatter:function(){var t=this.points[0].point.name,e=this.points[0].point.deaths,a=this.points[0].point.cases;return"<span style=\"font-size: 10px\">"+t+":</span><br><b>"+numberWithSep(this.y)+"%</b> ("+numberWithSep(e)+" \xF3bitos / "+numberWithSep(a)+" casos)"}},subtitle:{text:"Apenas alguns pa\xEDses que tem sido comparados ao Brasil s\xE3o representados neste gr\xE1fico. Diversos pa\xEDses possuem letalidade nesta faixa, mas n\xE3o s\xE3o mostrados.<br>A coluna 'Mundo' representa a m\xE9dia pelo n\xFAmero total de casos e \xF3bitos, e n\xE3o a m\xE9dia das letalidades de todos pa\xEDses."},caption:{useHTML:!0,text:"<a href=\"https://ourworldindata.org/coronavirus\" target=\"_blank\">Fonte: Our World in Data</a>"}});let G=formatToChart(worldData,"CFR","day_deaths");for(createLineChart("world_CFR_comp"),i=0;i<worldCompare.length;i++){let t=G.filter(function(t){return t.name==worldCompare[i]})[0];$("#world_CFR_comp").highcharts().addSeries({name:t.name,data:t.data},!1)}$("#world_CFR_comp").highcharts().update({chart:{marginTop:50},yAxis:{title:{text:"Varia\xE7\xE3o da letalidade"},labels:{format:"{value}%"}},xAxis:{type:"linear",tickInterval:2,labels:{rotation:0},title:{text:"Dia"}},title:{text:"Compara\xE7\xE3o da evolu\xE7\xE3o da taxa letalidade"},subtitle:{text:"A partir do 100\xBA \xF3bito"},legend:{enabled:!0},tooltip:{shared:!0,formatter:function(){var t="<span style=\"font-size: 10px\">Dia "+this.x+"</span>";return $.each(this.points,function(){t+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+this.y+"%</b> ",t+=" <span style=\"font-size: 10px\">("+Highcharts.dateFormat("%d/%m/%Y",this.point.date)+")</span>"}),t}},caption:{useHTML:!0,text:"<a href=\"https://ourworldindata.org/coronavirus\" target=\"_blank\">Fonte: Our World in Data</a>"},exporting:{buttons:{customButton:{enabled:!1}}}});let I=formatToChart(dbl_time,"dbl_time","date"),O=!1,N=formatDBLInterval(dbl_time,"dbl_time","date");for(createLineChart("world_DBL"),i=0;i<worldCompare.length;i++){let t=I.find(t=>t.name==worldCompare[i]);$("#world_DBL").highcharts().addSeries({name:t.name,data:t.data},!1)}$("#world_DBL").highcharts().update({chart:{marginTop:50},yAxis:{title:{text:"Tempo de duplica\xE7\xE3o (dias)"},min:2,tickInterval:1},title:{text:"Tempo de duplica\xE7\xE3o"},subtitle:{text:"Calculado com base nos \xF3bitos dos \xFAltimos 5 dias. Os ICs se referem a um n\xEDvel de confian\xE7a de 95%."},tooltip:{shared:!0,formatter:function(){var t=this.points||splat(this);t.sort(function(t,e){return t.y<e.y?1:t.y>e.y?-1:0});var e="<span style=\"font-size: 10px\">"+Highcharts.dateFormat("%A, %d/%m/%Y",this.x)+"</span>";return $.each(t,function(){"IC"!=this.series.name&&(e+="<br><span style=\"color:"+this.series.color+"\">\u25CF</span> "+this.series.name+": <b>"+numberWithSep(this.y)+"</b>",e+=" (IC: "+numberWithSep(this.point.dbl_time_lwr)+" - "+numberWithSep(this.point.dbl_time_upr)+") dias")}),e}},exporting:{buttons:{customButton:{text:"Mostrar ICs",onclick:function(){O=!O;let e=O?"Esconder ICs":"Mostrar ICs";this.exportSVGElements[2].attr({text:e}),t($("#sel_country").val())}}}},legend:{enabled:!0},caption:{useHTML:!0,text:"<a href=\"https://ourworldindata.org/coronavirus\" target=\"_blank\">Fonte: Our World in Data</a>"}}),console.log("Time to generate HS plots: "+(new Date().getTime()-starttimeHS)+"ms"),$("#loading, #wall").hide()}document.addEventListener("DOMContentLoaded",function(){dbl_time.map(t=>t.location=worldTrad[t.location]?worldTrad[t.location]:t.location),$("#sel_estado").select2({matcher:matchStart}),nomesEstados.forEach(function(t){$("#sel_estado").append(new Option(t,t))}),$("#sel_estado").val("S\xE3o Paulo"),starttimeW=new Date().getTime(),fetch(worldDataSource).then(function(t){t.text().then(function(t){rawWorldData=t,parseWorldData()})}),$.ajaxSetup({headers:{"x-parse-application-id":"unAFkcaNDeXajurGB7LChj8SgQYS2ptm"},error:function(){console.log("Erro (GET request failed): falha ao carregar dados do Minist\xE9rio da Sa\xFAde, utilizando dados em cache."),parseBrasilData(!1)}}),starttimeBR=new Date().getTime(),$.get(msGetURL,function(t){brasilDataSource=t.results[0].arquivo.url,"file:"==window.location.protocol?(console.log("Running locally and ignoring MS data."),parseBrasilData(!1)):fetch(brasilDataSource).then(function(t){t.text().then(function(t){rawBrasilData=t.replace("data","date").replace("estado","location").replace("casosNovos","new_cases").replace("casosAcumulados","total_cases").replace("obitosNovos","new_deaths").replace("obitosAcumulados","total_deaths"),parseBrasilData(!0)})}).catch(function(){console.log("Erro (file request failed): Falha ao carregar dados do Minist\xE9rio da Sa\xFAde, utilizando dados em cache."),parseBrasilData(!1)})},"json")});